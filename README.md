# KKTrain
This repository holds the scripts used to train the ANNs used in the KinKal track fitting adapter for the Mu2e experiment

The first step to run the notebook is to install a kernel that includes support for everything listed in requirements.txt. For working on nersc, see https://docs.nersc.gov/services/jupyter/#conda-environments-as-kernels Then, you can load a particular notebook. Note that data is stored on NERSC in: /global/cfs/cdirs/m3712/Mu2e/TrkAna

TrainBkg.ipynb is used to separate true electron track hits from those generated by background particles
TrainLRDrift.ipynb is used to separate hits which have accurate drift information, including left-right sign, from hits with either poor drift measurement (due to ion cluster effects) or an ambiguous left-right sign.

## Install

The first step to run the notebook is to install `mamba` (or `conda`) and JupyterLab. I personally prefer `mamba`. Installation packages are available [here](https://github.com/conda-forge/miniforge#mambaforge).

Once you have installed Mamba, you can install JupyterLab with:

```bash
mamba install -c conda-forge jupyterlab
```

Now, we need to create an environment containing the packages required by the tutorial. In the `KKTrain` directory run:

```bash
mamba create -n KKTrain -c conda-forge --file requirements.txt
```

This will create a `KKTrain` environment. In order to access it you can run
```bash
mamba activate KKTrain
```
We then want to add this environment to the list of _kernels_ available to JupyterLab:
```bash
python -m ipykernel install --user --name KKTrain --display-name KKTrain
```

Now, go back to your `base` environment and launch JupyterLab:
```
mamba activate base
jupyterlab
```

In order to use the `KKTrain` environment you just created select "KKTrain" in the list of kernels in the upper right part of the interface.  Then select one of the training scripts to run from the file browser.

